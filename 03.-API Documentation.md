# API Documentation
## General remarks
All Steamodded APIs are built on an Object Oriented Programming engine. As such, Steamodded objects share some common methods and parameters, described below.
### Creating an object
A new object is always created by calling the corresponding class with a single table parameter. Each class can have required fields and may provide some default values.

Your table must have a `key` field, which must be a unique string. Don't worry about collisions with other mods&mdash;your mod's prefix will always be prepended to `key`. With a few exceptions, you don't have to worry about this.
```lua
-- Skeleton for creating an object
SMODS.Class {
	key = 'key',
	other_param = 0,
	loc_txt = {
		-- ...
	},
}
``` 

### Common parameters
- `name`: The `name` field is used by the game to identify certain objects, but Steamodded doesn't use it at all. You can ignore it.
- `loc_txt`: Most objects display a text description, and some objects need to display additional text in Collections and other places. The `loc_txt` field defines these pieces of text. You can either provide a single table that will get used for every language, or provide a subtable for each language. If the selected language is not provided, the `default` subtable, the English (`'en_us'`) subtable, or `loc_txt` itself will be used as defaults, in that order. Refer to your object's documentation for what fields need to go in `loc_txt`.

	The following are examples of valid `loc_txt` tables:
	- `{ name = 'Name', text = { 'This is example text' } }`
	-
	```lua
		{
			['en-us'] = {
				name = 'Name',
				text = { 'Example', 'text', 'on', 'five', 'lines'},
			},
			['fr'] = {
				-- French translation
			},
			['nl'] = {
				-- Dutch translation
			},
			['default'] = {
				-- a different default text
				-- leave this empty to allow
				-- custom languages to provide
				-- their own translation
			}
		}
	```
	-
	```lua
	{
		['en-us'] = {
			-- Sometimes, more text is required than just a name and a description
			label = 'Label',
			description = {
				name = 'Name',
				text = { 'A moderately long', 'description of', 'your effect.' }
			}
		}
	}
	```
	-
	```lua
	{
		-- The simplest option: use a single table
		label = 'Label',
		description = {
			name = 'Name',
			text = { 'A moderately long', 'description of', 'your effect.' }
		}
	}
	```
- `unlocked` sets the default unlock state of an object. If this is set to `false`, you need to implement an unlock condition for your card to be obtainable.
- `discovered` sets the default discovery state of an object. If this is set to `true`, your card need not be found in a run before it can be viewed in the collection.
- `config` is a reserved table that allows setting initial values kept in a card's `ability` table. Only specific keys are recognized; it is recommended to define an `extra` table inside `config` for advanced functionality.
- `raw_atlas_key` is an optional parameter for all objects that require an `atlas` field. It is needed if you want to reference an atlas from the base game or another mod, as your mod prefix will otherwise be prepended to the atlas key.
```lua
config = {
	extra = {
		custom_value = 10,
		another_value = 'something',
	},
}
```
- `dependencies` allows you to specify one or multiple mods by their respective IDs. Your object will only be loaded when all specified mods are present. This is useful for cross-mod compatibility, but not for dependencies that are required for your mod to function properly. In such cases, add a dependency to your mod header.

### Taking ownership
You may need to modify vanilla objects as part of your mod. To achieve this while providing all of the same API functions as for modded objects, a separate method is used. Each provided key-value pair of the provided table overwrites the previously present value, while the rest of the object is left intact.
```lua
SMODS.Joker:take_ownership('joker', {
	cost = 5,
	calculate = function(card, context)
		-- more on this later
	end
})
```

### API functions
All available API functions are explained in detail on the page for their respective class. The following list establishes parameter names that are used throughout several such interfaces.
| Identifier 	| Meaning 		|
| :--------- 	| :--------- 	|
| `self`		| The table this method is defined on. This is generally a prototype object that can't keep track of state. |
| `card`		| An object of the game's `Card` class. Keeps track of state in an `ability` field. |